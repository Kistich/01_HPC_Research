# 🧹 隐藏文件清理脚本使用说明

## 📋 概述

`cleanup_hidden_files.sh` 是一个用于清理 macOS 系统自动生成的隐藏文件的脚本。

---

## 🎯 功能

该脚本会扫描并删除以下类型的文件：

1. **`._*` 文件** - macOS 资源分支文件（Resource Fork）
   - 这些文件存储文件的元数据和扩展属性
   - 在非 macOS 系统上是不需要的
   - 会污染项目目录

2. **`.DS_Store` 文件** - macOS 文件夹视图设置
   - 存储文件夹的显示选项
   - 不应该被提交到版本控制系统

---

## 🚀 使用方法

### 方法1：直接运行（推荐）

```bash
cd /Volumes/EXTERNAL_US/backup2/01_HPC_Research
bash cleanup_hidden_files.sh
```

### 方法2：使用执行权限

```bash
cd /Volumes/EXTERNAL_US/backup2/01_HPC_Research
chmod +x cleanup_hidden_files.sh
./cleanup_hidden_files.sh
```

---

## 📊 执行流程

1. **扫描阶段**
   - 扫描所有 `._*` 文件
   - 扫描所有 `.DS_Store` 文件
   - 显示统计信息和文件示例

2. **确认阶段**
   - 显示将要删除的文件数量
   - 等待用户确认（输入 `y` 继续，其他键取消）

3. **删除阶段**
   - 逐个删除文件
   - 每删除 10 个文件显示进度

4. **验证阶段**
   - 重新扫描确认所有文件已删除
   - 显示清理结果

---

## 📝 执行示例

```bash
$ bash cleanup_hidden_files.sh

============================================================================
清理隐藏文件脚本
============================================================================

项目根目录：/Volumes/EXTERNAL_US/backup2/01_HPC_Research

正在扫描 ._ 开头的文件...
正在扫描 .DS_Store 文件...

============================================================================
扫描结果
============================================================================
找到 ._* 文件：124 个
找到 .DS_Store 文件：1 个
总计：125 个文件

文件示例（前10个）：
/Volumes/EXTERNAL_US/backup2/01_HPC_Research/Stage01_data_filter_preprocess/._run_stable_processing.py
...

⚠️  警告：即将删除 125 个文件！
是否继续？(y/n)
y

============================================================================
开始清理
============================================================================
正在删除 ._* 文件...
  已删除 10 个文件...
  已删除 20 个文件...
  ...
  已删除 120 个文件...
正在删除 .DS_Store 文件...

============================================================================
清理完成
============================================================================
✅ 成功删除 124 个文件

✅ 验证通过：所有隐藏文件已清理干净！
```

---

## ✅ 首次清理结果

**执行时间：** 2025-11-29 17:36

**清理统计：**
- ✅ 删除 `._*` 文件：124 个
- ✅ 删除 `.DS_Store` 文件：1 个
- ✅ 总计：125 个文件
- ✅ 验证：所有隐藏文件已清理干净

---

## 🛡️ 预防措施

为了防止这些文件再次出现在版本控制中，已经更新了 `.gitignore` 文件：

```gitignore
# macOS 系统文件
.DS_Store
**/.DS_Store
._*
**/._*
```

---

## 🔧 定期维护

建议定期运行此脚本以保持项目目录整洁：

```bash
# 每周运行一次
cd /Volumes/EXTERNAL_US/backup2/01_HPC_Research
bash cleanup_hidden_files.sh
```

---

## ⚠️ 注意事项

1. **安全性**
   - 脚本只删除 `._*` 和 `.DS_Store` 文件
   - 不会删除其他隐藏文件（如 `.git`、`.gitignore` 等）
   - 删除前会要求用户确认

2. **权限**
   - 如果某些文件无法删除，可能是权限问题
   - 可以使用 `sudo` 运行脚本（不推荐）

3. **恢复**
   - 这些文件删除后无法恢复
   - 但它们会被 macOS 自动重新生成（如果需要）

---

## 📚 相关资源

- **macOS 资源分支文件：** https://en.wikipedia.org/wiki/Resource_fork
- **.DS_Store 文件：** https://en.wikipedia.org/wiki/.DS_Store
- **Git 忽略文件：** https://git-scm.com/docs/gitignore

---

## 🎯 总结

- ✅ 脚本已创建：`cleanup_hidden_files.sh`
- ✅ 首次清理完成：删除 125 个文件
- ✅ `.gitignore` 已更新：防止再次提交
- ✅ 项目目录已清理干净

**建议：** 定期运行此脚本以保持项目整洁！

